{% import "Ceres::PageDesign.Macros.LayoutContainer" as LayoutContainer %}

{% set totalsConfigData = config("Ceres.basket.data")|split(', ') %}

<div>
    <div class="row">
        <div class="col-md-6 m-b-2">
            <div class="card small">
                <!-- ORDER -->
                <div class="card-header">
                    <h5>{{ trans("Ceres::Template.orderId") }} {{ orderData.order.id }}</h5>
                </div>
                <div class="card-block">
                    <div class="details">
                        <div class="row">
                            <strong class="col-xs-6 col-sm-5">{{ trans("Ceres::Template.orderDate") }}</strong>
                            {#<span class="col-xs-6 col-sm-7">${ orderData.order.createdAt | date "{{ trans("Ceres::Template.dateTimeFormatMoment") }}" }</span> TODO#}
                        </div>

                        <div class="row">
                            <strong class="col-xs-6 col-sm-5">{{ trans("Ceres::Template.orderStatus") }}</strong>
                            <span class="col-xs-6 col-sm-7">{{ orderData.status.frontendName }}</span>
                        </div>
                    </div>

                    <hr>

                    <div>
                        <div class="row">
                            <strong class="col-xs-6 col-sm-5">{{ trans("Ceres::Template.orderInvoiceAddress") }}</strong>
                            <span class="col-xs-6 col-sm-7">
                                                        <div>{{ orderData.order.billingAddress.name1 }}</div>
                                                        <div>{{ orderData.order.billingAddress.name2 }} {{ orderData.order.billingAddress.name3 }}</div>
                                                        <div>{{ orderData.order.billingAddress.name4 }}</div>
                                                        <div>{{ orderData.order.billingAddress.address1 }} {{ orderData.order.billingAddress.address2 }}</div>
                                                        <div>{{ orderData.order.billingAddress.postalCode }} {{ orderData.order.billingAddress.town }}</div>
                                                    </span>
                        </div>

                        <div class="row m-t-1">
                            <strong class="col-xs-6 col-sm-5">{{ trans("Ceres::Template.orderShippingAddress") }}</strong>
                            <span class="col-xs-6 col-sm-7">
                                                        {% if orderData.order.billingAddress.id == orderData.order.deliveryAddress.id %}
                                                            <span>
                                                                {{ trans("Ceres::Template.addressSameAsInvoice") }}
                                                            </span>
                                                        {% else %}
                                                            <span>
                                                                <div>{{ orderData.order.deliveryAddress.name1 }}</div>
                                                                <div>{{ orderData.order.deliveryAddress.name2 }} {{ orderData.order.deliveryAddress.name3 }}</div>
                                                                <div>{{ orderData.order.deliveryAddress.name4 }}</div>
                                                                <div>{{ orderData.order.deliveryAddress.address1 }} {{ orderData.order.deliveryAddress.address2 }}</div>
                                                                <div>{{ orderData.order.deliveryAddress.postalCode }} {{ orderData.order.deliveryAddress.town }}</div>
                                                            </span>
                                                        {% endif %}
                                                    </span>
                        </div>
                    </div>

                    <hr>

                    <div>
                        <div class="row">
                            <strong class="col-xs-6 col-sm-5">{{ trans("Ceres::Template.orderPaymentMethod") }}</strong>
                            <span class="col-xs-6 col-sm-7">{{ orderData.paymentMethodName }}</span>
                        </div>
                        <div class="row">
                            <strong class="col-xs-6 col-sm-5">{{ trans("Ceres::Template.orderPaymentStatus") }}</strong>

                            {% for propertyKey in orderData.order.properties %}
                                {% if orderData.order.properties[propertyKey].typeId ==  17 and orderData.order.properties[propertyKey].subTypeId == 3 %}
                                    {% set paymentState = orderData.order.properties[propertyKey].value %}
                                {% endif %}
                            {% endfor %}

                            {% if paymentState == "unpaid" %}
                                <span class="col-xs-6 col-sm-7">{{ trans("Ceres::Template.paymentStatus_unpaid") }}</span>
                            {% elseif paymentState == "prepaid" %}
                                <span class="col-xs-6 col-sm-7">{{ trans("Ceres::Template.paymentStatus_prepaid") }}</span>
                            {% elseif paymentState == "partlyPaid" %}
                                <span class="col-xs-6 col-sm-7">{{ trans("Ceres::Template.paymentStatus_partlyPaid") }}</span>
                            {% elseif paymentState == "fullyPaid" %}
                                <span class="col-xs-6 col-sm-7">{{ trans("Ceres::Template.paymentStatus_fullyPaid") }}</span>
                            {% elseif paymentState == "overpaid" %}
                                <span class="col-xs-6 col-sm-7">{{ trans("Ceres::Template.paymentStatus_overpaid") }}</span>
                            {% endif %}
                        </div>

                        {{ LayoutContainer.show("Ceres::OrderConfirmation.AdditionalPaymentInformation", services.customer.getLatestOrder().order) }}

                    </div>

                    <hr>

                    <div>
                        <div class="row">
                            <strong class="col-xs-6 col-sm-5">{{ trans("Ceres::Template.orderShippingProfile") }}</strong>
                            <span class="col-xs-6 col-sm-7">{{ orderData.shippingProvider }} - {{ orderData.shippingProfileName }}</span>
                        </div>

                        <div class="row" v-if="shippingDate">
                            <strong class="col-xs-6 col-sm-5">{{ trans("Ceres::Template.orderEstimatedShippingDate") }}</strong>
                            {#<span class="col-xs-6 col-sm-7">{{ shippingDate | moment "{{ trans("Ceres::Template.dateFormatMoment") }}" }}</span> TODO#}
                        </div>
                    </div>

                </div>
                <!-- ORDER -->
            </div>

        </div>

        <div class="col-md-6">
            <div class="confirmation-order-list">

                {% for item in orderData.order.orderItems %}
                    {% if item.itemVariationId > 0 %}
                        <article class="cmp cmp-order-item">
                            <a href="{{ orderData.itemURLs[item.itemVariationId] }}" class="item-image">
                                <img src="{{ orderData.itemImages[item.itemVariationId] }}">
                            </a>
                            <div class="item-details small">
                                <a href="{{ orderData.itemURLs[item.itemVariationId] }}" class="clearfix">
                                    <div class="item-name">
                                        {{ item.orderItemName }}
                                    </div>
                                </a>
                                <div class="row">
                                    <strong class="col-xs-6 col-sm-3">{{ trans("Ceres::Template.orderPricePerPiece") }}</strong>
                                    {#<span class="col-xs-6 col-sm-9">{{ item.amounts[0].priceGross | currency item.amounts[0].currency }}</span> TODO#}
                                </div>
                                <div class="row">
                                    <strong class="col-xs-6 col-sm-3">{{ trans("Ceres::Template.orderPeace") }}</strong>
                                    <span class="col-xs-6 col-sm-9">{{ item.quantity }}</span>
                                </div>
                                <div class="row">
                                    <strong class="col-xs-6 col-sm-3">{{ trans("Ceres::Template.orderTotal") }}</strong>
                                    {#<strong class="col-xs-6 col-sm-9">{{ (item.quantity * item.amounts[0].priceGross) | currency item.amounts[0].currency }}</strong> TODO#}
                                </div>
                            </div>
                        </article>
                    {% endif %}
                {% endfor %}

            </div>
            <div class="gesamtsumme">
                <!-- BASKET TOTALS -->
                <div class="cmp cmp-totals">
                    <h3>{{ trans("Ceres::Template.basketSum") }}</h3>
                    <div>
                        <dl>
                            {% if "basket.value_of_items_net" in totalsConfigData %}
                            <dt>
                                {{ trans("Ceres::Template.basketValue") }} ({{ trans("Ceres::Template.basketNet") }})
                            </dt><!--
                     --><dd>
                                {#{{ totals.itemSumNet | currency totals.currency }} TODO#}
                            </dd>
                            {% endif %}

                            {% if "basket.value_of_items_gross" in totalsConfigData %}
                            <dt>
                                <strong>{{ trans("Ceres::Template.basketValue") }} ({{ trans("Ceres::Template.basketGross") }})</strong>
                            </dt><!--
                     --><dd>
                                {#<strong>{{ totals.itemSum | currency totals.currency }}</strong> TODO#}
                            </dd>
                            {% endif %}

                            {% if "basket.shipping_costs_net" in totalsConfigData %}
                            <dt>
                                {{ trans("Ceres::Template.itemShippingCosts") }} ({{ trans("Ceres::Template.basketNet") }})
                            </dt><!--
                     --><dd>
                                {#{{ totals.shippingAmountNet | currency totals.currency }} TODO#}
                            </dd>
                            {% endif %}

                            {% if "basket.shipping_costs_gross" in totalsConfigData %}
                            <dt>
                                <strong>{{ trans("Ceres::Template.itemShippingCosts") }} ({{ trans("Ceres::Template.basketGross") }})</strong>
                            </dt><!--
                     --><dd>
                                {#<strong>{{ totals.shippingAmount | currency totals.currency }}</strong> TODO#}
                            </dd>
                            {% endif %}

                            <hr>

                            {% set grossNet = LayoutContainer.show("Ceres::OrderConfirmation.GrossNetReplace", services.customer.getLatestOrder().order) %}
                            {% if grossNet|trim is not empty %}
                                {{ grossNet }}
                            {% else %}
                                {% if "basket.order_total_net" in totalsConfigData %}
                                <dt>
                                    {{ trans("Ceres::Template.basketTotalSum") }} ({{ trans("Ceres::Template.basketNet") }})
                                </dt><!--
                                --><dd>
                                {#{{ totals.totalAmountNet | currency totals.currency }} TODO#}
                            </dd>
                                {% endif %}


                                {#<dt v-if="totals.couponValue !== 0">#}
                                    {#<strong>{{ trans("Ceres::Template.basketCoupon") }}</strong>#}
                                {#</dt><!--#}
                                {#--><dd v-if="totals.couponValue !== 0">#}
                                {#<strong>${ totals.couponValue | currency totals.currency }</strong>#}
                            {#</dd> TODO#}

                                {% if "basket.vat" in totalsConfigData %}
                                <dt>
                                    {{ trans("Ceres::Template.basketVAT") }}
                                </dt><!--
                                 --><dd>
                                {#{{ totals.vat | currency totals.currency }} TODO#}
                            </dd>
                                {% endif %}

                                <hr>

                                {% if "basket.order_total_gross" in totalsConfigData %}
                                <dt>
                                    <strong>{{ trans("Ceres::Template.basketTotalSum") }} ({{ trans("Ceres::Template.basketGross") }})</strong>
                                </dt><!--
                                --><dd>
                                {#<strong>{{ totals.totalAmount | currency totals.currency }}</strong> TODO#}
                            </dd>
                                {% endif %}

                            {% endif %}

                            {{ LayoutContainer.show("Ceres::OrderConfirmation.AfterTotals", services.customer.getLatestOrder().order) }}
                        </dl>
                    </div>
                </div>
                <!-- ./BASKET TOTALS -->
            </div>
        </div>
    </div>
</div>