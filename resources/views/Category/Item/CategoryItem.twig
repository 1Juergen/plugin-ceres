{% extends "PluginCallisto::PageDesign.PageDesign" %}

{% set itemSort             = request.get("itemSorting") | default( config('PluginCallisto.sort.defaultSorting') ) | split('_') %}
{% set orderBy              = itemSort[0] %}
{% set orderByKey           = itemSort[1] | default('ASC') %}
{% set variationShowType    = config("PluginCallisto.global.category.variation_show_type") %}
{% set categoryParams = {
    'variationShowType' : config("PluginCallisto.global.category.variation_show_type"),
    'itemsPerPage'      : request.get("items_per_page") | default( config('PluginCallisto.pagination.defaultItemsPerPage') ),
    'orderBy'           : itemSort[0],
    'orderByKey'        : itemSort[1] | default('ASC')
} %}

{% set page                 = request.get("page") | default(1) %}
{% set paginatedResult      = services.category.getItems(category, categoryParams, page ) %}

{% set itemList             = paginatedResult.getResult() %}
{% set paginationType       = config("PluginCallisto.sort.paginationPosition") %}

{% block PageBody %}
    <div class="categoriegrid container">
        <div class="row m-t-3 m-b-2">
            <div class="col-xs-12">
                <h1>{{ category.details.first.name }}</h1>
                <hr class="hidden-sm-down">
            </div>
        </div>
        <div class="row m-b-3">
            <div class="col-lg-3">
                {% include "PluginCallisto::Category.Item.Partials.CategoryViewFilter" %}
            </div>

            <div class="col-lg-9">
                <div class="list-controls row">
                    {% include "PluginCallisto::Category.Item.Partials.ListControls" with { 'paginatedResult': paginatedResult } %}

                    <div class="col-xs-12 col-sm-6 m-b-1">

                        {% include "PluginCallisto::Category.Item.Partials.Pagination" with { 'paginatedResult': paginatedResult } %}
                    </div>
                </div>

                <hr class="m-b-1 hidden-sm-down">
                    <ul class="product-list row grid">
                        {% for item in itemList %}
                            <li>
                              {% include "PluginCallisto::Category.Item.Partials.CategoryListItem" with { 'item': item } %}
                            </li>
                        {% endfor %}
                    </ul>
                <hr class="m-y-2">

                <div class="list-controls m-b-3 row">
                    <div class="col-xs-12">
                        {% include "PluginCallisto::Category.Item.Partials.Pagination" with { 'paginatedResult': paginatedResult } %}
                    </div>

                </div>
            </div>
        </div>
    </div>
{% endblock %}
